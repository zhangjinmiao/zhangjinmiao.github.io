<!DOCTYPE html><html lang="zh-cmn-Hans" prefix="og: http://ogp.me/ns#" class="han-init"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" /><title>常用 Linux 命令 &mdash; 山川尽美</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/zhangjinmiao/zhangjinmiao.github.io@master/assets/vendor/primer-css/css/primer.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/zhangjinmiao/zhangjinmiao.github.io@master/assets/css/components/collection.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/zhangjinmiao/zhangjinmiao.github.io@master/assets/css/components/repo-card.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/zhangjinmiao/zhangjinmiao.github.io@master/assets/css/sections/repo-list.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/zhangjinmiao/zhangjinmiao.github.io@master/assets/css/components/boxed-group.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/zhangjinmiao/zhangjinmiao.github.io@master/assets/css/globals/common.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/zhangjinmiao/zhangjinmiao.github.io@master/assets/css/globals/responsive.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/zhangjinmiao/zhangjinmiao.github.io@master/assets/css/posts/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/zhangjinmiao/zhangjinmiao.github.io@master/assets/vendor/octicons/octicons/octicons.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/mzlogin/rouge-themes@master/dist/pastie.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/zhangjinmiao/zhangjinmiao.github.io@master/assets/vendor/share.js/dist/css/share.min.css"><link rel="canonical" href="http://zhangjinmiao.github.io/linux/2018/04/22/%E5%B8%B8%E7%94%A8Linux%E5%91%BD%E4%BB%A4.html"><link rel="alternate" type="application/atom+xml" title="山川尽美" href="http://zhangjinmiao.github.io"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/zhangjinmiao/zhangjinmiao.github.io@master/favicon.ico"><meta property="og:title" content="常用 Linux 命令"><meta name="keywords" content="Linux, 命令"><meta name="og:keywords" content="Linux, 命令"><meta name="description" content="进程和端口相关"><meta name="og:description" content="进程和端口相关"><meta property="og:url" content="http://zhangjinmiao.github.io/linux/2018/04/22/%E5%B8%B8%E7%94%A8Linux%E5%91%BD%E4%BB%A4.html"><meta property="og:site_name" content="山川尽美"><meta property="og:type" content="article"><meta property="og:locale" content="zh_CN" /><meta property="article:published_time" content="2018-04-22"> <script src="https://cdn.jsdelivr.net/gh/zhangjinmiao/zhangjinmiao.github.io@master/assets/vendor/jquery/dist/jquery.min.js"></script> <script src="https://cdn.jsdelivr.net/gh/zhangjinmiao/zhangjinmiao.github.io@master/assets/js/jquery-ui.js"></script> <script src="https://cdn.jsdelivr.net/gh/zhangjinmiao/zhangjinmiao.github.io@master/assets/js/main.js"></script> <script data-ad-client="ca-pub-7093222719567591" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script></head><body class="" data-mz=""><header class="site-header"><div class="container"><h1><a href="http://zhangjinmiao.github.io/" title="山川尽美"><span class="octicon octicon-mark-github"></span> 山川尽美</a></h1><button class="collapsed mobile-visible" type="button" onclick="toggleMenu();"> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button><nav class="site-header-nav" role="navigation"> <a href="http://zhangjinmiao.github.io/" class=" site-header-nav-item" target="" title="首页">首页</a> <a href="http://zhangjinmiao.github.io/categories/" class=" site-header-nav-item" target="" title="分类">分类</a> <a href="http://zhangjinmiao.github.io/archives/" class=" site-header-nav-item" target="" title="归档">归档</a> <a href="http://zhangjinmiao.github.io/spring-boot.html" class=" site-header-nav-item" target="_blank" title="Spring Boot">Spring Boot</a> <a href="http://zhangjinmiao.github.io/payment.html" class=" site-header-nav-item" target="_blank" title="支付">支付</a> <a href="http://zhangjinmiao.github.io/about.html" class=" site-header-nav-item" target="" title="关于">关于</a></nav></div></header><section class="collection-head small geopattern" data-pattern-id="常用 Linux 命令"><div class="container"><div class="columns"><div class="column three-fourths"><div class="collection-title"><h1 class="collection-header">常用 Linux 命令</h1><div class="collection-info"> <span class="meta-info"> <span class="octicon octicon-calendar"></span> 2018/04/22 </span> <span class="meta-info"> <span class="octicon octicon-file-directory"></span> <a href="http://zhangjinmiao.github.io/categories/#Linux" title="Linux">Linux</a> </span> <span class="meta-info"> <span class="octicon octicon-clock"></span> 共 7029 字，约 21 分钟 </span></div></div></div><div class="column one-fourth mobile-hidden"><div class="collection-title"> <img style="height:72px;width:72px" src="https://cdn.jsdelivr.net/gh/zhangjinmiao/zhangjinmiao.github.io@master/assets/images/qrcode.jpg" alt="山川尽美" /></div></div></div></div></section><section class="container content"><div class="columns"><div class="column three-fourths"><article class="article-content markdown-body"><h2 id="进程和端口相关">进程和端口相关</h2><ol><li>查看端口占用</li></ol><p>查看端口 8080 的使用情况：</p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  netstat <span class="nt">-tln</span> | <span class="nb">grep </span>8080
</code></pre></div></div><ol><li>查看端口属于哪个程序</li></ol><p>(list open files) 是一个列出当前系统打开文件的工具</p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  lsof <span class="nt">-i</span> :8080
  用于显示tcp，udp的端口和进程等相关情况：netstat <span class="nt">-tunlp</span>
</code></pre></div></div><ol><li>新开端口</li></ol><p>su 切换到 root 下，输入密码：XXXX，直接执行以下命令：</p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  0.查看状态：iptables <span class="nt">-L</span> <span class="nt">-n</span>
  1.以6016 端口为例：/sbin/iptables <span class="nt">-I</span> INPUT <span class="nt">-p</span> tcp <span class="nt">--dport</span> 6016 <span class="nt">-j</span> ACCEPT
  2.保存命令：/etc/rc.d/init.d/iptables save
  3.查看状态：/etc/init.d/iptables status
</code></pre></div></div><ol><li>查看进程</li></ol><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  表示查看所有进程里 CMD 是 java 的进程信息： ps <span class="nt">-ef</span> | <span class="nb">grep </span>java
  查看java进程，-aux 显示所有状态：ps <span class="nt">-aux</span>|grep java 
  查看所有进程：ps aux
  用于查看指定端口号的进程情况：netstat <span class="nt">-tunlp</span>|grep 端口号
</code></pre></div></div><ol><li>查看程序是否运行</li></ol><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  查看 java 进程： ps <span class="nt">-ef</span>|grep java
  查看 tomcat 进程： ps <span class="nt">-ef</span>|grep tomcat
</code></pre></div></div><ol><li>终止进程</li></ol><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  终止进程号位19979的进程：kill <span class="nt">-9</span> 19979
  优雅的停止：kill 进程号
</code></pre></div></div><h3 id="netstat-命令介绍">netstat 命令介绍</h3><p>netstat 命令用于显示与 IP、TCP、UDP 和 ICMP 协议相关的统计数据，一般用于检验本机各端口的网络连接情况  </p><p>-a 显示一个所有的有效连接信息列表(包括已建立的连接，也包括监听连接请求的那些连接)  </p><p>-n 显示所有已建立的有效连接  </p><p>-t tcp 协议  </p><p>-u udp 协议  </p><p>-l 查询正在监听的程序  </p><p>-p 显示正在使用 socket 的程序识别码和程序名称  </p><p>​</p><ol><li>通过端口号获取进程号</li></ol><p>方式一：</p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  netstat <span class="nt">-tunlp</span>|grep 6019
</code></pre></div></div><p>netstat -tunlp 用于显示 tcp，udp 的端口和进程等相关情况</p><p><img src="https://github.com/zhangjinmiao/zhangjinmiao.github.io/raw/master/assets/images/2018/linux/1.png" alt="" /></p><p>方式二：</p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  lsof <span class="nt">-i</span>:6019
</code></pre></div></div><p>lsof -i 用以显示符合条件的进程情况，lsof(list open files) 是一个列出当前系统打开文件的工具。</p><p><img src="https://github.com/zhangjinmiao/zhangjinmiao.github.io/raw/master/assets/images/2018/linux/2.png" alt="" /></p><ol><li>获取某个进程的网络端口号</li></ol><p>查看进程号为 20446 的端口号，如图箭头所指“6016”即是；方框显示的是该程序所调用的端口，包括</p><p>mongodb 的 27017，mysql (显示了别名，其实是 3306)，rabbitmq 的 amqp(其实是 5672)</p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  netstat  <span class="nt">-ap</span> | <span class="nb">grep </span>20446
</code></pre></div></div><p><img src="https://github.com/zhangjinmiao/zhangjinmiao.github.io/raw/master/assets/images/2018/linux/3.png" alt="" /></p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  不显示别名：
  netstat  <span class="nt">-anp</span> | <span class="nb">grep </span>20446
</code></pre></div></div><p><img src="https://github.com/zhangjinmiao/zhangjinmiao.github.io/raw/master/assets/images/2018/linux/4.png" alt="" /></p><ol><li>显示当前正在监听的服务名称</li></ol><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  netstat <span class="nt">-tl</span>
</code></pre></div></div><ol><li>查看开启了哪些端口</li></ol><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  netstat <span class="nt">-lntp</span> 
</code></pre></div></div><p><img src="https://github.com/zhangjinmiao/zhangjinmiao.github.io/raw/master/assets/images/2018/linux/5.png" alt="" /></p><ol><li>查看系统监听的端口</li></ol><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  netstat -na|grep -i listen 
</code></pre></div></div><p><img src="https://github.com/zhangjinmiao/zhangjinmiao.github.io/raw/master/assets/images/2018/linux/6.jpg" alt="" /></p><ol><li>查看已建立的连接进程，所占用的端口</li></ol><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  netstat  <span class="nt">-antup</span>
</code></pre></div></div><p><img src="https://github.com/zhangjinmiao/zhangjinmiao.github.io/raw/master/assets/images/2018/linux/7.jpg" alt="" /></p><ol><li>查看后台运行的进程总数</li></ol><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  ps  <span class="nt">-ef</span>|wc <span class="nt">-l</span> 
</code></pre></div></div><ol><li>查看 java 进程</li></ol><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  ps <span class="nt">-aux</span> | <span class="nb">grep </span>java 或
  ps <span class="nt">-ef</span> | <span class="nb">grep </span>java
</code></pre></div></div><p>(grep ——global search regular expression(RE) and print out the line 全文正则匹配并打印)</p><p><strong>ps：将某个进程显示出来</strong></p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nt">-A</span> 　显示所有程序。 
  <span class="nt">-e</span> 　此参数的效果和指定<span class="s2">"A"</span>参数相同。
  <span class="nt">-f</span> 　显示UID,PPIP,C与STIME栏位。 
    
  grep命令是查找
  中间的|是管道命令 是指ps命令与grep同时执行
  UID PID PPID C STIME TTY TIME CMD
  各相关信息的意义：
  
  UID 程序被该 UID 所拥有
  
  PID 就是这个程序的 ID 
  PPID 则是其上级父程序的ID
  C CPU 使用的资源百分比
  STIME 系统启动时间
  TTY 登入者的终端机位置
  TIME 使用掉的 CPU 时间。
  CMD 所下达的指令为何
</code></pre></div></div><h3 id="查看连接状态">查看连接状态</h3><ol><li>各种连接</li></ol><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  netstat <span class="nt">-n</span> | <span class="nb">awk</span> <span class="s1">'/^tcp/ {++S[$NF]} END {for(a in S) print a, S[a]}'</span>
</code></pre></div></div><p><strong>解释:</strong> 返回结果示例：</p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  LAST_ACK 5  <span class="o">(</span>正在等待处理的请求数<span class="o">)</span> 
  SYN_RECV 30 
  ESTABLISHED 1597 <span class="o">(</span>正常数据传输状态<span class="o">)</span> 
  FIN_WAIT1 51 
  FIN_WAIT2 504 
  TIME_WAIT 1057 <span class="o">(</span>处理完毕，等待超时结束的请求数<span class="o">)</span>
</code></pre></div></div><p>状态：描述</p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  CLOSED：无连接是活动的或正在进行 
  LISTEN：服务器在等待进入呼叫 
  SYN_RECV：一个连接请求已经到达，等待确认 
  SYN_SENT：应用已经开始，打开一个连接 
  ESTABLISHED：正常数据传输状态 
  FIN_WAIT1：应用说它已经完成 
  FIN_WAIT2：另一边已同意释放 
  ITMED_WAIT：等待所有分组死掉 
  CLOSING：两边同时尝试关闭 
  TIME_WAIT：另一边已初始化一个释放 
  LAST_ACK：等待所有分组死掉
  
</code></pre></div></div><ol><li><p>并发连接数</p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>netstat <span class="nt">-nat</span>|grep ESTABLISHED|wc <span class="nt">-l</span>
</code></pre></div></div></li><li><p>查看某个端口的连接数</p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>netstat <span class="nt">-nat</span> | <span class="nb">grep</span> <span class="nt">-iw</span> <span class="s2">"9090"</span> | <span class="nb">wc</span> <span class="nt">-l</span>
</code></pre></div></div></li><li><p>查看连接状况</p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>netstat <span class="nt">-nat</span> | <span class="nb">grep</span> <span class="nt">-iw</span> <span class="s2">"9090"</span>
</code></pre></div></div></li></ol><h2 id="网络操作">网络操作</h2><p>查看网络通不通 ping www.baidu.com</p><blockquote><p>ubutu@10-10-80-30:~$ ping www.baidu.com PING www.a.shifen.com (180.97.33.108) 56(84) bytes of data. 64 bytes from 180.97.33.108: icmp_seq=1 ttl=48 time=27.6 ms 64 bytes from 180.97.33.108: icmp_seq=2 ttl=48 time=27.6 ms 64 bytes from 180.97.33.108: icmp_seq=3 ttl=48 time=27.5 ms 64 bytes from 180.97.33.108: icmp_seq=4 ttl=48 time=27.6 ms</p></blockquote><p>telnet 域名/IP 端口号</p><blockquote><p>test_user@10-10-80-30:~$ ttelnet www.baidu.com 80 Trying 61.135.169.125… Connected to www.a.shifen.com. Escape character is ‘^]’.</p></blockquote><p>hosts 加入域名</p><blockquote><p>1.使用root sudo vi /etc/hosts 按 “Inter”输入， 按 “Esc”,”:wq” 保存退出</p></blockquote><h2 id="搜索相关">搜索相关</h2><h3 id="grep">grep</h3><ol><li>统计某个字符串的行数</li></ol><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nb">grep</span> <span class="nt">-wi</span> <span class="nt">-c</span> Eleme info-20180322.log_0
</code></pre></div></div><p>统计 emele 的行数，忽略大小写</p><p><img src="https://github.com/zhangjinmiao/zhangjinmiao.github.io/raw/master/assets/images/2018/linux/8.png" alt="" /></p><ol><li>使用 grep 搜索</li></ol><p>查询关键字 eleme、412、413 并高亮</p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="nb">grep</span> <span class="nt">-wi</span> <span class="nt">--color</span> <span class="s1">'eleme\|412\|413'</span> info-20180322.log_0 xxxxxxxxxx 
</code></pre></div></div><p><img src="https://github.com/zhangjinmiao/zhangjinmiao.github.io/raw/master/assets/images/2018/linux/9.png" alt="" /></p><ol><li><p>查询字符串出现次</p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">grep</span> <span class="nt">-o</span> <span class="s1">'复制'</span> info.log | <span class="nb">wc</span> <span class="nt">-l</span>
</code></pre></div></div><h2 id="文件操作相关">文件操作相关</h2></li><li><p>文件复制</p></li></ol><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  复制文件：cp <span class="nb">source </span>dest  <span class="nb">source</span> ：原文件， dest : 要复制到的目录
  递归复制整个文件夹：cp <span class="nt">-r</span> sourceFolder targetFolder 
  远程拷贝：scp sourecFile romoteUserName@remoteIp:remoteAddr
</code></pre></div></div><ol><li>删除目录</li></ol><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  删除空目录：rmdir deleteEmptyFolder
  递归删除目录中所有内容：rm <span class="nt">-rf</span> deleteFile
  
  删除除指定文件以外的文件及文件夹：
   <span class="nb">rm</span> <span class="nt">-rf</span> <span class="sb">`</span><span class="nb">ls</span> |grep <span class="nt">-v</span> <span class="s2">"redis.conf"</span> <span class="sb">`</span>
</code></pre></div></div><ol><li>创建文件</li></ol><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  vi filename
</code></pre></div></div><ol><li>移动文件</li></ol><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nb">mv</span> /temp/movefile /targetFolder
</code></pre></div></div><ol><li>重命名</li></ol><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nb">mv </span>oldNameFile newNameFile
</code></pre></div></div><ol><li>修改文件权限</li></ol><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  file.java的权限 <span class="nt">-rwx-rwx-rwx</span>，r 表示读、w 表示写、x 表示可执行：chmod 777 file.java
</code></pre></div></div><ol><li>文件查看</li></ol><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  查看文件头10 行：head <span class="nt">-n</span> 10 info.log
  查看文件尾10 行：tail <span class="nt">-n</span> 10 info.log
  查看文件尾10 行并监听文件：tail <span class="nt">-10f</span> info.log
</code></pre></div></div><ol><li>文件查找</li></ol><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  find  /dir <span class="nt">-name</span> filename <span class="o">[</span>在目录 <span class="nb">dir </span>下查找文件名为 filename 的文件]
  find <span class="nb">.</span> <span class="nt">-name</span> “<span class="k">*</span>.log” <span class="o">[</span>在当前目录下查找扩展名为 log 的文件]
</code></pre></div></div><ol><li>打包文件夹</li></ol><p><strong>zip 方式</strong></p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  zip  <span class="nt">-r</span> ./eleme.zip ./eleme/    压缩当前文件夹下的 eleme 文件夹 为 eleme.zip
  
  zip  <span class="nt">-r</span> ./eleme.zip ./<span class="k">*</span>/  	   压缩当前文件夹下的所有文件 为 eleme.zip
  
  unzip test.zip 将压缩文件 text.zip 在当前目录下解压缩
  
  unzip <span class="nt">-v</span> test.zip 查看压缩文件目录，但不解压
  
  unzip <span class="nt">-n</span> test.zip <span class="nt">-d</span> /tmp 将压缩文件 text.zip 在指定目录 /tmp 下解压缩，如果已有相同的文件存在，要求 unzip 命令不覆盖原先的文件
  
  unzip <span class="nt">-o</span> test.zip <span class="nt">-d</span> /tmp 将压缩文件 test.zip 在指定目录 /tmp 下解压缩，如果已有相同的文件存在，要求 unzip 命令覆盖原先的文件
</code></pre></div></div><p><strong>tar 方式</strong>：</p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nt">-z</span> : gzip压缩
  
  <span class="nb">tar</span> <span class="nt">-czvf</span> log.tar log.info :  压缩单个文件 
  
  <span class="nb">tar</span> <span class="nt">-czvf</span>  log.tar  log.info 2018-03-22-info.log    压缩多个文件
  
  <span class="nb">tar</span> <span class="nt">-czvf</span> my.tar dir1 dir2  多个目录压缩打包
  
  解包至当前目录：tar <span class="nt">-zxvf</span> my.tar
  
  <span class="nb">tar</span> <span class="nt">-ztvf</span> log.tar.gz 查阅 <span class="nb">tar </span>包内有哪些文件
  
  <span class="nb">tar</span> <span class="nt">-zxvf</span> test.tar test.txt 解压部分文件
</code></pre></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&gt;注：c 参数代表 create（创建），x 参数代表 extract（解包），v 参数代表 verbose（详细信息），f 参数代表 filename（文件名），所以 f 后必须接文件名。
</code></pre></div></div><ol><li><p>传包</p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>scp Alipay.jar 用户名@127.0.0.1:/usr/work/alipay
</code></pre></div></div></li><li><p>拷贝 从其他目录拷贝文件到当前目录：</p></li></ol><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   先进入当前目录，然后：cp 源文件目录  <span class="nb">.</span>         <span class="o">(</span>  .代表当前目录<span class="o">)</span>
</code></pre></div></div><h3 id="日志查看">日志查看</h3><ol><li>按行号查看，过滤出关键字附近的日志</li></ol><ul><li><p>①先查看关键字所在的行号：</p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nb">cat</span> <span class="nt">-n</span> info-20180319.log_0 | <span class="nb">grep</span> <span class="s1">'权限'</span>
</code></pre></div></div></li><li><p>②‘权限’所在行号是 102，查看这个关键字前 10 行和后 10 行的日志：</p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat</span> <span class="nt">-n</span> info-20180319.log_0 | <span class="nb">tail</span> <span class="nt">-n</span> +92|head <span class="nt">-n</span> 20
</code></pre></div></div><p><strong>说明：</strong> tail -n + 92 表示查询 92 行之后的日志 head -n 20 则表示在前面的查询结果里再查前 20 条记录</p></li></ul><p>如果日志比较多可以分页查看：</p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nb">cat</span> <span class="nt">-n</span> info-20180319.log_0 | <span class="nb">grep</span> <span class="s1">'权限'</span> | more
</code></pre></div></div><p>或者写入文件：</p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nb">cat</span> <span class="nt">-n</span> info-20180319.log_0 | <span class="nb">grep</span> <span class="s1">'权限'</span> <span class="o">&gt;</span> xxx.log
</code></pre></div></div><p>2.按日期查看</p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nb">sed</span> <span class="s1">'/2018-03-19 00:02:40/,/2018-03-19 01:02:40/p'</span> info-20180319.log_0 
</code></pre></div></div><h3 id="linux-打开文件数-too-many-open-files-解决方法">linux 打开文件数 too many open files 解决方法</h3><p><a href="https://blog.csdn.net/fdipzone/article/details/34588803">参考</a></p><ol><li><p>查看每个用户最大允许打开文件数量 ulimit -a</p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>zhxdidi@web-mod md-consume]<span class="nv">$ </span><span class="nb">ulimit</span> <span class="nt">-a</span>
core file size          <span class="o">(</span>blocks, <span class="nt">-c</span><span class="o">)</span> 0
data seg size           <span class="o">(</span>kbytes, <span class="nt">-d</span><span class="o">)</span> unlimited
scheduling priority             <span class="o">(</span><span class="nt">-e</span><span class="o">)</span> 0
file size               <span class="o">(</span>blocks, <span class="nt">-f</span><span class="o">)</span> unlimited
pending signals                 <span class="o">(</span><span class="nt">-i</span><span class="o">)</span> 172032
max locked memory       <span class="o">(</span>kbytes, <span class="nt">-l</span><span class="o">)</span> 32
max memory size         <span class="o">(</span>kbytes, <span class="nt">-m</span><span class="o">)</span> unlimited
open files                      <span class="o">(</span><span class="nt">-n</span><span class="o">)</span> 1024
pipe size            <span class="o">(</span>512 bytes, <span class="nt">-p</span><span class="o">)</span> 8
POSIX message queues     <span class="o">(</span>bytes, <span class="nt">-q</span><span class="o">)</span> 819200
real-time priority              <span class="o">(</span><span class="nt">-r</span><span class="o">)</span> 0
stack size              <span class="o">(</span>kbytes, <span class="nt">-s</span><span class="o">)</span> 10240
cpu <span class="nb">time</span>               <span class="o">(</span>seconds, <span class="nt">-t</span><span class="o">)</span> unlimited
max user processes              <span class="o">(</span><span class="nt">-u</span><span class="o">)</span> 172032
virtual memory          <span class="o">(</span>kbytes, <span class="nt">-v</span><span class="o">)</span> unlimited
file locks                      <span class="o">(</span><span class="nt">-x</span><span class="o">)</span> unlimited
</code></pre></div></div><p>其中 open files (-n) 1024 表示每个用户最大允许打开的文件数量是 1024</p></li><li><p>查看当前系统打开的文件数量 (list open files)是一个列出当前系统打开文件的工具</p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lsof | <span class="nb">wc</span> <span class="nt">-l</span>    或  
watch <span class="s2">"lsof | wc -l"</span>  每 2 秒监控
</code></pre></div></div></li><li><p>查看某一进程的打开文件数量</p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lsof <span class="nt">-p</span> pid | <span class="nb">wc</span> <span class="nt">-l</span>   pid 为进程号
</code></pre></div></div></li><li><p>设置 open files 数值方法 方式一:临时</p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">ulimit</span> <span class="nt">-n</span> 2048
</code></pre></div></div><p>方式二：永久</p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vim /etc/security/limits.conf  
在最后加入  
<span class="k">*</span> soft nofile 4096  
<span class="k">*</span> hard nofile 4096  
最前的 <span class="k">*</span> 表示所有用户，可根据需要设置某一用户
重启系统，通过shutdown <span class="nt">-r</span> now  命令重启即可。
</code></pre></div></div></li></ol><h2 id="系统管理相关">系统管理相关</h2><ol><li>查看空间大小</li></ol><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  磁盘空间：df <span class="nt">-h</span> 
  目录大小：du <span class="nt">-sh</span> <span class="k">*</span>
</code></pre></div></div><ol><li><strong>chmod 命令</strong></li></ol><p>该命令用于改变文件的权限，一般的用法如下：</p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nb">chmod</span> <span class="o">[</span><span class="nt">-R</span><span class="o">]</span> xyz 文件或目录
  <span class="nt">-R</span>：进行递归的持续更改，即连同子目录下的所有文件都会更改
</code></pre></div></div><p>同时，chmod 还可以使用 u（user）、g（group）、o（other）、a（all）和+（加入）、-（删除）、=（设置）跟 rwx 搭配来对文件的权限进行更改。</p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="c"># 例如：</span>
  <span class="nb">chmod </span>0755 file <span class="c"># 把file的文件权限改变为-rxwr-xr-x</span>
  <span class="nb">chmod </span>g+w file <span class="c"># 向file的文件权限中加入用户组可写权限</span>
</code></pre></div></div><p>权限范围的表示法如下：</p><p><code class="language-plaintext highlighter-rouge">u</code> User，即文件或目录的拥有者； <code class="language-plaintext highlighter-rouge">g</code> Group，即文件或目录的所属群组； <code class="language-plaintext highlighter-rouge">o</code> Other，除了文件或目录拥有者或所属群组之外，其他用户皆属于这个范围； <code class="language-plaintext highlighter-rouge">a</code> All，即全部的用户，包含拥有者，所属群组以及其他用户； <code class="language-plaintext highlighter-rouge">r</code> 读取权限，数字代号为“4”; <code class="language-plaintext highlighter-rouge">w</code> 写入权限，数字代号为“2”； <code class="language-plaintext highlighter-rouge">x</code> 执行或切换权限，数字代号为“1”； <code class="language-plaintext highlighter-rouge">-</code> 不具任何权限，数字代号为“0”； <code class="language-plaintext highlighter-rouge">s</code> 特殊功能说明：变更文件或目录的权限。</p><p>777 代表： rwxrwxrwx ，意思是该登录用户（可以用命令 id 查看）、他所在的组和其他人都有最高权限。</p><p>r=4，w=2，x=1 </p><p>若要 rwx 属性则 4+2+1=7；<br /> 若要 rw- 属性则 4+2=6； 若要 r-x 属性则 4+1=5。 </p><pre><code class="language- sh">  -rw------- (600) -- 只有属主有读写权限。  
  -rw-r--r-- (644) -- 只有属主有读写权限；而属组用户和其他用户只有读权限。  
  -rwx------ (700) -- 只有属主有读、写、执行权限。  
  -rwxr-xr-x (755) -- 属主有读、写、执行权限；而属组用户和其他用户只有读、执行权限。  
  -rwx--x--x (711) -- 属主有读、写、执行权限；而属组用户和其他用户只有执行权限。  
  -rw-rw-rw- (666) -- 所有用户都有文件读、写权限。这种做法不可取。  
  -rwxrwxrwx (777) -- 所有用户都有读、写、执行权限。更不可取的做法。 
</code></pre><ol><li>查看 Linux 系统位数</li></ol><p><strong>方法一：</strong></p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  file /sbin/init 或者 file /bin/ls
</code></pre></div></div><p><img src="https://github.com/zhangjinmiao/zhangjinmiao.github.io/raw/master/assets/images/2018/linux/10.png" alt="" /></p><p><img src="https://github.com/zhangjinmiao/zhangjinmiao.github.io/raw/master/assets/images/2018/linux/11.png" alt="" /></p><p><strong>方法二：</strong></p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nb">uname</span> <span class="nt">-a</span>
</code></pre></div></div><p><img src="https://github.com/zhangjinmiao/zhangjinmiao.github.io/raw/master/assets/images/2018/linux/12.png" alt="" /></p><p><strong>方法三：</strong></p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  getconf LONG_BIT
</code></pre></div></div><p><img src="https://github.com/zhangjinmiao/zhangjinmiao.github.io/raw/master/assets/images/2018/linux/13.png" alt="" /></p><ol><li>查看内核数 <strong>方法一：</strong></li></ol><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nb">cat</span> /proc/cpuinfo | <span class="nb">grep </span>name | <span class="nb">cut</span> <span class="nt">-f2</span> <span class="nt">-d</span>: | <span class="nb">uniq</span> <span class="nt">-c</span>
</code></pre></div></div><p><img src="https://github.com/zhangjinmiao/zhangjinmiao.github.io/raw/master/assets/images/2018/linux/16.png" alt="" /></p><p><strong>方法二：</strong></p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nb">cat</span> /proc/cpuinfo |grep <span class="s2">"processor"</span>|wc <span class="nt">-l</span>	
</code></pre></div></div><p><img src="https://github.com/zhangjinmiao/zhangjinmiao.github.io/raw/master/assets/images/2018/linux/17.png" alt="" /></p><ol><li><p>查看磁盘大小</p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">df</span> -h
</code></pre></div></div><p><img src="https://github.com/zhangjinmiao/zhangjinmiao.github.io/raw/master/assets/images/2018/linux/14.png" alt="" /></p><blockquote><p>df -hl 查看磁盘剩余空间 df -h 查看每个根路径的分区大小 du -sh [目录名] 返回该目录的大小 du -sm [文件夹] 返回该文件夹总 M 数</p></blockquote><p>更多功能可以输入一下命令查看：</p><blockquote><p>df –help du –help</p></blockquote></li><li><p>查看内存大小</p></li></ol><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  free <span class="nt">-m</span>  按M计算
</code></pre></div></div><p><img src="https://github.com/zhangjinmiao/zhangjinmiao.github.io/raw/master/assets/images/2018/linux/15.png" alt="" /></p><ol><li>查看 CPU 使用率</li></ol><p><strong>实时 CPU 使用率：</strong></p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  top	
</code></pre></div></div><p><img src="https://github.com/zhangjinmiao/zhangjinmiao.github.io/raw/master/assets/images/2018/linux/18.png" alt="" /></p><p><strong>CPU 处理器使用率:</strong></p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nb">cat</span>  /proc/stat cpu
</code></pre></div></div><p><img src="https://github.com/zhangjinmiao/zhangjinmiao.github.io/raw/master/assets/images/2018/linux/19.png" alt="" /></p><p><strong>平均 CPU 使用率:</strong></p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nb">cat</span>  /proc/loadavg
</code></pre></div></div><p><img src="https://github.com/zhangjinmiao/zhangjinmiao.github.io/raw/master/assets/images/2018/linux/20.png" alt="" /></p><ol><li><p>查看 CPU 基本信息</p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat</span> /proc/cpuinfo
</code></pre></div></div></li></ol><p><img src="https://github.com/zhangjinmiao/zhangjinmiao.github.io/raw/master/assets/images/2018/linux/21.png" alt="" /></p><h3 id="命令-crontab">命令 Crontab</h3><p>linux 自带的定时任务</p><ol><li>查看是否安装了 crontab<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rpm <span class="nt">-qa</span> | <span class="nb">grep </span>crontab
</code></pre></div></div></li><li>服务启动、关闭<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>启动：/etc/init.d/crond start
关闭：/etc/init.d/crond stop
重启：/etc/init.d/crond restart
重新载入配置：/etc/init.d/crond reload
</code></pre></div></div></li><li>配置文件</li></ol><p>在 etc/目录下存在 cron.hourly,cron.daily,cron.weekly,cron.monthly,cron.d 五个目录和 crontab,cron.deny 二 个文件</p><ol><li>查看 cron<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>crontab <span class="nt">-l</span>
</code></pre></div></div></li><li>编辑<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>crontab <span class="nt">-e</span>
</code></pre></div></div></li></ol><h3 id="新增用户">新增用户</h3><p>1.新增用户 username</p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>useradd username
</code></pre></div></div><p>2.给用户 username 设置密码：</p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>passwd username
</code></pre></div></div><blockquote><p>useradd 命令添加用户，则默认用户名和组都是相同的名称；<br /> /etc/passwd 文件纪录的系统所有用户列表；<br /> /etc/group 文件纪录系统的组信息。</p></blockquote><p>3.将用户添加到 wheel 组，否则无法使用 sudo 命令</p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>usermod <span class="nt">-G</span> wheel username
</code></pre></div></div><p>4.查看用户所属组</p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">groups</span>
</code></pre></div></div><p><strong>禁止 root 远程登录</strong></p><p>1.修改 ssh 配置文件：sudo vi /etc/sshd_config，将 PermitRootLogin 设置为 no</p><p>2.重启 ssh 服务：sudo systemctl restart sshd</p><div style="margin-top:2em;padding:0 1.5em;border:1px solid #d3d3d3;background-color:#deebf7"><h3>文档信息</h3><ul><li>本文作者：<a href="http://zhangjinmiao.github.io" target="_blank">Zhang jinmiao</a></li><li>本文链接：<a href="http://zhangjinmiao.github.io/linux/2018/04/22/%E5%B8%B8%E7%94%A8Linux%E5%91%BD%E4%BB%A4.html" target="_blank">http://zhangjinmiao.github.io/linux/2018/04/22/%E5%B8%B8%E7%94%A8Linux%E5%91%BD%E4%BB%A4.html</a></li><li>版权声明：自由转载-非商用-非衍生-保持署名（<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/deed.zh" target="_blank">创意共享3.0许可证</a>）</li></ul></div></article><div class="share"><div class="share-component" data-disabled='qq,facebook'></div></div><div class="comment"> <script src="https://beaudar.lipk.org/client.js" repo="zhangjinmiao/blog-comments" issue-term="title" label="gitment" theme="github-light" comment-order="desc" input-position="top" crossorigin="anonymous" async> </script></div></div><div class="column one-fourth"><h3>Search</h3><div id="site_search"> <input style="width:96%" type="text" id="search_box" placeholder="Search"></div><ul id="search_results" style="font-size:14px;list-style-type:none;padding-top:10px;padding-left:10px;"></ul><script src="https://cdn.jsdelivr.net/gh/zhangjinmiao/zhangjinmiao.github.io@master/assets/js/simple-jekyll-search.min.js"></script> <script type="text/javascript"> SimpleJekyllSearch({ searchInput: document.getElementById('search_box'), resultsContainer: document.getElementById('search_results'), json: 'https://cdn.jsdelivr.net/gh/zhangjinmiao/zhangjinmiao.github.io@built/assets/search_data.json?v=1661247380', searchResultTemplate: '<li><a href="{url}" title="{title}">{title}</a></li>', noResultsText: 'No results found', limit: 10, fuzzy: false, exclude: ['Welcome'] }) </script><h3 class="post-directory-title mobile-hidden">Table of Contents</h3><div id="post-directory-module" class="mobile-hidden"><section class="post-directory"><dl></dl></section></div><script src="https://cdn.jsdelivr.net/gh/zhangjinmiao/zhangjinmiao.github.io@master/assets/js/jquery.toc.js"></script></div></div></section><footer class="container"><div class="site-footer" role="contentinfo"><div class="copyright left mobile-block"> © 2015 <span title="Zhang jinmiao">Zhang jinmiao</span> <a href="javascript:window.scrollTo(0,0)" class="right mobile-visible">TOP</a></div><ul class="site-footer-links right mobile-hidden"><li> <a href="javascript:window.scrollTo(0,0)" >TOP</a></li></ul><a href="https://github.com/zhangjinmiao/zhangjinmiao.github.io" target="_blank" aria-label="view source code"> <span class="mega-octicon octicon-mark-github" title="GitHub"></span> </a><ul class="site-footer-links mobile-hidden"><li> <a href="http://zhangjinmiao.github.io/links.html" title="链接" target="_blank">链接</a></li><li> <a href="http://zhangjinmiao.github.io/used-urls.html" title="网址" target="_blank">网址</a></li><li> <a href="http://zhangjinmiao.github.io/money.html" title="挣钱" target="_blank">挣钱</a></li><li> <a href="http://zhangjinmiao.github.io/todo.html" title="TODO" target="_blank">TODO</a></li><li> <a href="http://zhangjinmiao.github.io/open-source.html" title="Code" target="_blank">Code</a></li><li><a href="http://zhangjinmiao.github.io"><span class="octicon octicon-rss" style="color:orange;"></span></a></li></ul></div><div class="site-footer" role="contentinfo" style="padding-top:0px;border-top:none;"><div style="text-align:center;"> <a target="_blank" style="color:#777" href="http://beian.miit.gov.cn/">晋ICP备19009201号-1</a></div><div style="text-align:center"> <img src="http://zhangjinmiao.github.io/assets/images/2019/备案图标.png"> <a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=11010802029536" style="display:inline-block;text-decoration:none;height:20px;line-height:20px;"><img src="" style="float:left;"/><p style="float:left;height:20px;line-height:20px;margin: 0px 0px 0px 5px; color:#939393;">京公网安备 11010802029536号</p></a></div><div class="mobile-hidden" style="text-align:center;" > <span id="busuanzi_container_site_pv">本站总访问量:<span id="busuanzi_value_site_pv"></span>次/</span> <span id="busuanzi_container_site_uv">本站访客数<span id="busuanzi_value_site_uv"></span>人/</span> <span id="busuanzi_container_page_pv">本页访问量<span id="busuanzi_value_page_pv"></span>次/</span> 统计始于2018-03-12 <span id="htmer_time"></span></div><script async src="https://cdn.jsdelivr.net/gh/zhangjinmiao/zhangjinmiao.github.io@master/assets/vendor/busuanzi/2.3/busuanzi.pure.mini.js"></script> <script language=JavaScript> function secondToDate(second) { if (!second) { return 0; } var time = new Array(0, 0, 0, 0, 0); if (second >= 365 * 24 * 3600) { time[0] = parseInt(second / (365 * 24 * 3600)); second %= 365 * 24 * 3600; } if (second >= 24 * 3600) { time[1] = parseInt(second / (24 * 3600)); second %= 24 * 3600; } if (second >= 3600) { time[2] = parseInt(second / 3600); second %= 3600; } if (second >= 60) { time[3] = parseInt(second / 60); second %= 60; } if (second > 0) { time[4] = second; } return time; } </script> <script type="text/javascript" language="javascript"> function setTime() { var create_time = Math.round(new Date(Date.UTC(2018, 3, 12, 0, 0, 0)).getTime() / 1000); var timestamp = Math.round((new Date().getTime() + 8 * 60 * 60 * 1000) / 1000); currentTime = secondToDate((timestamp - create_time)); currentTimeHtml = '默默运行了' + currentTime[0] + '年' + currentTime[1] + '天' + currentTime[2] + '时' + currentTime[3] + '分' + currentTime[4] + '秒'; document.getElementById("htmer_time").innerHTML = currentTimeHtml; } setInterval(setTime, 1000); </script></div></footer><script src="https://cdn.jsdelivr.net/gh/zhangjinmiao/zhangjinmiao.github.io@master/assets/vendor/share.js/dist/js/share.min.js"></script> <script src="https://cdn.jsdelivr.net/gh/zhangjinmiao/zhangjinmiao.github.io@master/assets/js/geopattern.js"></script> <script> jQuery(document).ready(function($) { $('.geopattern').each(function(){ $(this).geopattern($(this).data('pattern-id')); }); /* hljs.initHighlightingOnLoad(); */ }); </script></body></html>
